meta: 'An example fit using Colibri, hadronic dataset.'

#######################
# Data and theory specs
#######################

dataset_inputs:    
  # Hadronic
  - {'dataset': 'DYE866_Z0_800GEV_DW_RATIO_PDXSECRATIO', 'variant': 'legacy'}
  - {'dataset': 'DYE866_Z0_800GEV_PXSEC', 'variant': 'legacy'}
  - {'dataset': 'DYE605_Z0_38P8GEV_DW_PXSEC', 'variant': 'legacy'}
  - {'dataset': 'DYE906_Z0_120GEV_DW_PDXSECRATIO', 'variant': 'legacy', 'cfac': ['ACC']}
  - {'dataset': 'CDF_Z0_1P96TEV_ZRAP', 'variant': 'legacy'}
  - {'dataset': 'D0_Z0_1P96TEV_ZRAP', 'variant': 'legacy'}
  - {'dataset': 'D0_WPWM_1P96TEV_ASY', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_DY_7TEV_36PB_ETA', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_Z0_7TEV_49FB_HIMASS', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_Z0_7TEV_LOMASS_M', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_DY_7TEV_46FB_CC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_Z0_7TEV_46FB_CF-Y', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_Z0_8TEV_HIMASS_M-Y', 'variant': 'legacy'}

  - {'dataset': 'ATLAS_Z0_8TEV_LOWMASS_M-Y', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_DY_13TEV_TOT', 'variant': 'legacy', 'cfac': ['NRM']}
  - {'dataset': 'ATLAS_WJ_JET_8TEV_WP-PT', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_WJ_JET_8TEV_WM-PT', 'variant': 'legacy'}

  - {'dataset': 'ATLAS_Z0J_8TEV_PT-M', 'variant': 'legacy_10'}
  - {'dataset': 'ATLAS_Z0J_8TEV_PT-Y', 'variant': 'legacy_10'}
  - {'dataset': 'ATLAS_TTBAR_7TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_TTBAR_8TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_TTBAR_13TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_TTBAR_8TEV_LJ_DIF_YT-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_TTBAR_8TEV_LJ_DIF_YTTBAR-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_TTBAR_8TEV_2L_DIF_YTTBAR-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_PH_13TEV_XSEC', 'variant': 'legacy', 'cfac': ['EWK']}
  - {'dataset': 'ATLAS_SINGLETOP_7TEV_TCHANNEL-XSEC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_SINGLETOP_13TEV_TCHANNEL-XSEC', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_SINGLETOP_7TEV_T-Y-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_SINGLETOP_7TEV_TBAR-Y-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_SINGLETOP_8TEV_T-RAP-NORM', 'variant': 'legacy'}
  - {'dataset': 'ATLAS_SINGLETOP_8TEV_TBAR-RAP-NORM', 'variant': 'legacy'}
  - {'dataset': 'CMS_WPWM_7TEV_ELECTRON_ASY'}
  - {'dataset': 'CMS_WPWM_7TEV_MUON_ASY', 'variant': 'legacy'}
  - {'dataset': 'CMS_Z0_7TEV_DIMUON_2D'}
  - {'dataset': 'CMS_WPWM_8TEV_MUON_Y', 'variant': 'legacy'}
  - {'dataset': 'CMS_Z0J_8TEV_PT-Y', 'cfac': ['NRM'], 'variant': 'legacy_10'}
  - {'dataset': 'CMS_TTBAR_7TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_8TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_13TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_8TEV_LJ_DIF_YTTBAR-NORM', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_5TEV_TOT_X-SEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_8TEV_2L_DIF_MTTBAR-YT-NORM', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_13TEV_2L_DIF_YT', 'variant': 'legacy'}
  - {'dataset': 'CMS_TTBAR_13TEV_LJ_2016_DIF_YTTBAR', 'variant': 'legacy'}
  - {'dataset': 'CMS_SINGLETOP_7TEV_TCHANNEL-XSEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_SINGLETOP_8TEV_TCHANNEL-XSEC', 'variant': 'legacy'}
  - {'dataset': 'CMS_SINGLETOP_13TEV_TCHANNEL-XSEC', 'variant': 'legacy'}
  - {'dataset': 'LHCB_Z0_7TEV_DIELECTRON_Y'}
  - {'dataset': 'LHCB_Z0_8TEV_DIELECTRON_Y'}
  - {'dataset': 'LHCB_DY_7TEV_MUON_Y', 'cfac': ['NRM']}
  - {'dataset': 'LHCB_DY_8TEV_MUON_Y', 'cfac': ['NRM']}
  - {'dataset': 'LHCB_Z0_13TEV_DIMUON-Y'}
  - {'dataset': 'LHCB_Z0_13TEV_DIELECTRON-Y'}


theoryid: 40001000                          # The theory from which the predictions are drawn.
use_cuts: internal                     # The kinematic cuts to be applied to the data.

closure_test_level: 0                  # The closure test level: False for experimental, level 0
                                       # for pseudodata with no noise, level 1 for pseudodata with
                                       # noise.
closure_test_pdf: NNPDF40_nnlo_as_01180 # The closure test PDF used if closure_level is not False
reduced_xgrid_data: True               # An artefact of the old grid_pdf implementation,
                                       # ensuring we generate closure test data using the model.

#####################
# Loss function specs
#####################

positivity:                            # Positivity datasets, used in the positivity penalty.
  posdatasets:
  - {dataset: POSF2U, maxlambda: 1e6}

alpha: 1e-7                           
lambda_positivity: 0                 

use_fit_t0: True                       # Whether the t0 covariance is used in the chi2 loss.
t0pdfset: NNPDF40_nnlo_as_01180         # The t0 PDF used to build the t0 covariance matrix.


#############
# Model specs
#############
flavour_mapping: ["\\Sigma", "g", "V"]
# Grid PDF settings
grid_pdf_settings:
  xgrids:
    photon: []
    \Sigma: [0.001, 0.01, 0.05]
    g: [0.001, 0.01, 0.05]
    V: [0.001, 0.01, 0.05]
    V3: []
    V8: []
    V15: []
    V24: []
    V35: []
    T3: []
    T8: []
    T15: []
    T24: []
    T35: []


###################
# Methodology specs
###################

# Monte Carlo settings
use_gen_t0: True                       # Whether the t0 covariance is used to generated pseudodata.
max_epochs: 5000                       # The max number of epochs in Monte Carlo training.
mc_validation_fraction: 0.0            # The fraction of the data used for validation in Monte Carlo training.


mc_initialiser_settings:               # The initialiser for Monte Carlo training.
  type: pdf                        # This setting starts with all parameters equal to zero.
  pdf_set: NNPDF40_nnlo_as_01180
  init_type: uniform
  nsigma: 5

actions_:
- run_monte_carlo_fit                        # Choose from ultranest_fit, monte_carlo_fit, analytic_fit
